<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>Codegy - Single Editor with Examples</title>
<!-- FontAwesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<style>
  html, body, #container {
    margin: 0; padding: 0; height: 100%; width: 100%;
    overflow: hidden;
    font-family: Arial, sans-serif;
    background: #1e1e1e;
    color: #ddd;
    display: flex;
    flex-direction: column;
  }
  #toolbar-main {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    background: #2d2d2d;
    padding: 8px 10px;
    align-items: center;
    justify-content: flex-start;
  }
  #toolbar-main button {
    background: #3a3a3a;
    border: none;
    color: #eee;
    padding: 6px 12px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: background 0.2s;
  }
  #toolbar-main button:hover {
    background: #575757;
  }

  #toolbar-langs {
    display: flex;
    gap: 8px;
    background: #2d2d2d;
    padding: 6px 10px;
    justify-content: center;
  }
  #toolbar-langs button {
    background: #444;
    color: #ddd;
    padding: 6px 14px;
    border-radius: 4px;
    border: none;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.2s;
  }
  #toolbar-langs button.active,
  #toolbar-langs button:hover {
    background: #007acc;
    color: white;
  }

  #container {
    flex: 1 1 auto;
    position: relative;
  }

  /* Remove all borders, outlines, shadows on Monaco Editor */
  .monaco-editor, 
  .monaco-editor-background, 
  .margin, 
  .monaco-scrollable-element, 
  .lines-content, 
  .view-lines,
  .monaco-editor .inputarea.ime-input {
    border: none !important;
    box-shadow: none !important;
    outline: none !important;
    background: transparent !important;
  }
  .monaco-editor:focus {
    outline: none !important;
    box-shadow: none !important;
  }

  /* Style Monaco Editor font and background */
  .monaco-editor {
    background-color: #1e1e1e !important;
  }

  /* Result iframe */
  #result-frame {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    width: 100%;
    height: 100%;
    border: none;
    background: white;
    display: none;
    z-index: 1000;
  }

  /* Responsive */
  @media (max-width: 600px) {
    #toolbar-main {
      justify-content: center;
      padding: 6px 5px;
    }
    #toolbar-main button {
      font-size: 12px;
      padding: 5px 10px;
    }
    #toolbar-langs button {
      padding: 5px 10px;
      font-size: 13px;
    }
  }
</style>
</head>
<body>

<div id="toolbar-main">
  <button id="btn-run" title="Run (Show Result)"><i class="fas fa-play"></i> Run</button>
  <button id="btn-clear" title="Clear Editor"><i class="fas fa-trash"></i> Clear</button>
  <button id="btn-save" title="Save Code"><i class="fas fa-save"></i> Save</button>
  <button id="btn-export" title="Export as HTML"><i class="fas fa-file-export"></i> Export</button>
  <button id="btn-select-all" title="Select All"><i class="fas fa-mouse-pointer"></i> Select All</button>
  <button id="btn-hide" title="Hide Result" style="display:none"><i class="fas fa-times"></i> Close</button>
</div>

<div id="toolbar-langs">
  <button id="lang-html" class="active">HTML</button>
  <button id="lang-css">CSS</button>
  <button id="lang-js">JavaScript</button>
</div>

<div id="container"></div>

<iframe id="result-frame" sandbox="allow-scripts allow-same-origin"></iframe>

<!-- Monaco Editor CDN -->
<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs/loader.js"></script>
<script>
  require.config({ paths: { 'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.44.0/min/vs' }});

  let editor;
  let currentLanguage = 'html';

  const examples = {
    html: `<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Example HTML</title>
</head>
<body>
  <h1 style="color: #007acc;">Welcome to HTML Example</h1>
  <p>This is a simple HTML example.</p>
</body>
</html>`,

    css: `/* CSS Example */
body {
  background-color: #f0f0f0;
  color: #333;
  font-family: Arial, sans-serif;
  padding: 20px;
}
h1 {
  color: #007acc;
  text-align: center;
}
p {
  font-size: 16px;
}`,

    javascript: `// JavaScript Example
function greet() {
  alert('Hello from JavaScript!');
}
greet();`
  };

  require(['vs/editor/editor.main'], function () {
    editor = monaco.editor.create(document.getElementById('container'), {
      value: examples.html,
      language: 'html',
      theme: 'vs-dark',
      automaticLayout: true,
      minimap: { enabled: false },
      scrollbar: { vertical: 'auto', horizontal: 'auto' },
      suggestOnTriggerCharacters: true,
      quickSuggestions: true,
      wordBasedSuggestions: true,
      fontSize: 14,
      lineNumbers: "on",
      overviewRulerLanes: 0,
      glyphMargin: false,
      folding: false,
      lineDecorationsWidth: 0,
      lineNumbersMinChars: 2,
      cursorBlinking: 'smooth',
      contextmenu: false,
      renderLineHighlight: "none"
    });
  });

  // Buttons handlers
  document.getElementById('btn-run').onclick = () => {
    const code = editor.getValue();
    const iframe = document.getElementById('result-frame');
    let content = '';
    if (currentLanguage === 'html') {
      content = code;
    } else if (currentLanguage === 'css') {
      content = `<style>${code}</style><div>Hello CSS applied!</div>`;
    } else if (currentLanguage === 'javascript') {
      content = `<script>${code}<\/script><div>JavaScript executed! Check console.</div>`;
    }
    iframe.style.display = 'block';
    iframe.srcdoc = content;
    document.getElementById('btn-hide').style.display = 'inline-flex';
  };

  document.getElementById('btn-hide').onclick = () => {
    document.getElementById('result-frame').style.display = 'none';
    document.getElementById('btn-hide').style.display = 'none';
  };

  document.getElementById('btn-clear').onclick = () => {
    editor.setValue('');
  };

  document.getElementById('btn-save').onclick = () => {
    const blob = new Blob([editor.getValue()], { type: 'text/plain;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `code_${currentLanguage}.${currentLanguage === 'javascript' ? 'js' : currentLanguage}`;
    document.body.appendChild(a);
    a.click();
    setTimeout(() => {
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }, 0);
  };

  document.getElementById('btn-export').onclick = () => {
    if(currentLanguage === 'html'){
      const code = editor.getValue();
      const blob = new Blob([code], { type: 'text/html;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'exported.html';
      document.body.appendChild(a);
      a.click();
      setTimeout(() => {
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }, 0);
    } else {
      alert('Export is only supported for HTML language.');
    }
  };

  document.getElementById('btn-select-all').onclick = () => {
    editor.focus();
    editor.setSelection({
      startLineNumber: 1,
      startColumn: 1,
      endLineNumber: editor.getModel().getLineCount(),
      endColumn: editor.getModel().getLineMaxColumn(editor.getModel().getLineCount())
    });
  };

  // Language buttons
  const langButtons = document.querySelectorAll('#toolbar-langs button');
  langButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      langButtons.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      let lang = btn.id.replace('lang-', '');
      if(lang === 'js') lang = 'javascript'; // just in case
      currentLanguage = lang;

      editor.setValue(examples[lang] || '');
      monaco.editor.setModelLanguage(editor.getModel(), lang);
      document.getElementById('result-frame').style.display = 'none';
      document.getElementById('btn-hide').style.display = 'none';
      editor.focus();
    });
  });
</script>
</body>
</html>
